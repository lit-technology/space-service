CREATE TABLE IF NOT EXISTS post (
	id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	user_id BIGINT,
	name VARCHAR(180) NOT NULL,
	urls VARCHAR(200),
	name_hidden BOOLEAN NOT NULL,
	space_id BIGINT NOT NULL,
	upvote INT NOT NULL DEFAULT 0,
	downvote INT NOT NULL DEFAULT 0,
	rating SMALLINT,
	start_date TIMESTAMP,
	end_date TIMESTAMP,
	price INT,
	created TIMESTAMP DEFAULT now(),
	deleted TIMESTAMP
);

CREATE TABLE IF NOT EXISTS post_user (
	user_id BIGINT NOT NULL,
	post_id BIGINT NOT NULL,
	PRIMARY KEY(user_id, post_id)
);

CREATE TABLE IF NOT EXISTS post_space (
	space_id BIGINT NOT NULL,
	post_id BIGINT NOT NULL,
	PRIMARY KEY(space_id, post_id)
);

CREATE TABLE IF NOT EXISTS post_tag (
	tag VARCHAR(50) NOT NULL,
	post_id BIGINT NOT NULL,
	PRIMARY KEY(tag, post_id)
);

CREATE TABLE IF NOT EXISTS post_vote (
	user_id BIGINT NOT NULL,
	post_id BIGINT NOT NULL,
	vote BOOLEAN,
	PRIMARY KEY(user_id, post_id)
);

CREATE TABLE IF NOT EXISTS comment (
	id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	post_id BIGINT NOT NULL,
	user_id BIGINT NOT NULL,
	reply_id BIGINT,
	text VARCHAR(180) NOT NULL,
	upvote INT NOT NULL DEFAULT 0,
	downvote INT NOT NULL DEFAULT 0,
	created TIMESTAMP DEFAULT NOW(),
	deleted TIMESTAMP
);

CREATE TABLE IF NOT EXISTS comment_vote (
	user_id BIGINT NOT NULL,
	comment_id BIGINT NOT NULL,
	vote BOOLEAN,
	PRIMARY KEY(user_id, comment_id)
);
